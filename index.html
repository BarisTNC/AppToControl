<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sunucu Kontrol Paneli</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        h1 { color: #333; }
        .container { width: 80%; margin: auto; }
        .button { 
            display: inline-block; padding: 15px 30px; margin: 10px; 
            font-size: 18px; cursor: pointer; border: none; border-radius: 8px;
        }
        .shutdown { background: red; color: white; }
        .restart { background: orange; color: white; }
        .sleep { background: blue; color: white; }
        #clientList { margin-top: 20px; }
        #message { margin-top: 20px; font-size: 18px; color: green; }
    </style>
</head>
<body>
    <h1>Sunucu Kontrol Paneli</h1>
    
    <div class="container">
        <h2>BaÄŸlÄ± Ä°stemciler</h2>
        <ul id="clientList"></ul>
        
        <h2>Komut GÃ¶nder</h2>
        <select id="clientId">
            <option value="">Ä°stemci SeÃ§in</option>
        </select>
        <br><br>
        <button class="button shutdown" onclick="sendCommand('shutdown')">Shutdown</button>
        <button class="button restart" onclick="sendCommand('restart')">Restart</button>
        <button class="button sleep" onclick="sendCommand('sleep')">Sleep</button>

        <p id="message"></p>
    </div>

    <script>
        const API_URL = "http://127.0.0.1:5000";  // API'nin Ã§alÄ±ÅŸtÄ±ÄŸÄ± adresi yazÄ±n
        const API_KEY = "your_secret_api_key";    // API Key'i buraya ekleyin

        // ðŸ“¡ BaÄŸlÄ± istemcileri getir
        async function getClients() {
            const response = await fetch(API_URL + "/clients", {
                method: "GET",
                headers: { "X-API-KEY": API_KEY }
            });
            const data = await response.json();
            const clientList = document.getElementById("clientList");
            const clientDropdown = document.getElementById("clientId");
            
            clientList.innerHTML = "";
            clientDropdown.innerHTML = '<option value="">Ä°stemci SeÃ§in</option>';

            data.clients.forEach(client => {
                const li = document.createElement("li");
                li.innerText = client;
                clientList.appendChild(li);

                const option = document.createElement("option");
                option.value = client;
                option.innerText = client;
                clientDropdown.appendChild(option);
            });
        }

        // ðŸ“¤ Komut gÃ¶nder
        async function sendCommand(command) {
            const clientId = document.getElementById("clientId").value;
            if (!clientId) {
                alert("Ã–nce bir istemci seÃ§in!");
                return;
            }

            const response = await fetch(API_URL + "/send-command", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "X-API-KEY": API_KEY
                },
                body: JSON.stringify({ client_id: clientId, command: command })
            });

            const data = await response.json();
            document.getElementById("message").innerText = data.message;
        }

        // Sayfa yÃ¼klendiÄŸinde istemcileri getir
        window.onload = getClients;
    </script>
</body>
</html>
